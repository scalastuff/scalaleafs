/*! jQuery calendar 1.0.2 (c) github.com/teamdf/jquery-calendar | opensource.teamdf.com/license */
(function(f){var j="cal";var d="1.0.1";var g="month";var h="week";var e={startdate:null,daystodisplay:null,startmonth:null,startyear:null,monthstodisplay:null,defaultcolor:"#255BA1",invalidcolor:"#888888",maskmonthlabel:"l",maskeventlabel:"g:i A",maskdatelabel:"D, jS",masktimelabel:{"00":"g:i <\\sp\\a\\n>A</\\sp\\a\\n>",noon:"\\N\\O\\O\\N"},resources:false,minwidth:130,minheight:null,overlapoffset:15,daytimestart:"00:00:00",daytimeend:"24:00:00",weekstart:1,dragincrement:"15 mins",gridincrement:"15 mins",creationsize:"15 mins",allowcreation:"both",allowmove:false,allowresize:false,allowselect:false,allowremove:false,allowoverlap:false,allownotesedit:false,easing:{eventupdate:"linear",eventremove:"linear",eventeditin:"linear",eventeditout:"linear",datechange:"linear"},eventcreate:f.noop,eventnotesedit:f.noop,eventremove:f.noop,eventselect:f.noop,eventmove:f.noop,eventresize:f.noop,dayclick:f.noop,daydblclick:f.noop,onload:f.noop};var k={prevent:function(l){l.preventDefault()},scrollbarSize:function(){if(!k._scrollbarSize){var m=f(document.body),l=m.css({overflow:"hidden"}).width();l-=m.css({overflow:"scroll"}).width();if(!l){l=m.width()-m[0].clientWidth}m.css({overflow:""});k._scrollbarSize=l}return k._scrollbarSize},_scrollbarSize:false,selectrange:function(m,l){return this.each(function(){if(this.setSelectionRange){this.focus();this.setSelectionRange(m,l)}else{if(this.createTextRange){var n=this.createTextRange();n.collapse(true);n.moveEnd("character",l);n.moveStart("character",m);n.select()}}})},onscroll:function(p){var o=f(this),n=o.parent(".ui-"+j+"-container"),q=o.scrollLeft(),m=o.scrollTop(),l=n.data(j);if(l){n.find(".ui-"+j+"-timeline").scrollTop(m);n.find(".ui-"+j+"-dateline").scrollLeft(q);n.find(".ui-"+j+"-resourceline").scrollLeft(q)}},between:function(m,o,l){if(m instanceof Date){var n=m.getTime();return(n>=o.getTime()&&n<=l.getTime())}else{if(!isNaN(Number(m))){return(m>=o&&m<=l)}}return false},inrange:function(m,n,o,l){return !(n.getTime()<o.getTime()||m.getTime()>l.getTime())},resource:function(l,o){var n=0;if(o.settings.resources!==false){for(var m in o.settings.resources){if(o.settings.resources.hasOwnProperty(m)){if(n==l){return{id:m,name:o.settings.resources[m]}}n++}}}return{id:null,name:null}},resourceIndex:function(o,n){var l=0;if(n.settings.resources!==false){if(f.isArray(n.settings.resources)){for(var m in n.settings.resources){if(n.settings.resources[m]==o){return l}l++}}else{for(var m in n.settings.resources){if(n.settings.resources.hasOwnProperty(m)){if(m==o){return l}l++}}}}return false},overlaps:function(m,p,n){var t=f(this),r=t.data(j),l=[];if(r){var u=r.cache.events;for(var s in u){if(u.hasOwnProperty(s)&&(u[s].begins<p&&u[s].ends>m&&u[s].resource===n)){u[s].overlap={partial:true,inset:0,count:0,items:{},uid:s};l.push(u[s])}}if(l.length>1){l.sort(function(w,v){return w.begins.getTime()-v.begins.getTime()});for(var q in l){if(l.hasOwnProperty(q)){for(var o in l){if(q===o){continue}if(l.hasOwnProperty(o)&&!(l[q].overlap.uid in l[o].overlap.items)&&!(l[o].overlap.uid in l[q].overlap.items)&&(l[q].begins<l[o].ends&&l[q].ends>l[o].begins&&l[q].resource===l[o].resource)){l[q].overlap.items[l[o].overlap.uid]=l[o];l[o].overlap.items[l[q].overlap.uid]=l[q];l[q].overlap.count++;l[o].overlap.count++;if(l[q].begins.getTime()==l[o].begins.getTime()){l[q].overlap.partial=false;l[o].overlap.partial=false;l[o].overlap.inset=l[q].overlap.inset+1}else{if(l[q].begins.getTime()<l[o].begins.getTime()){if(l[q].overlap.partial){l[o].overlap.inset++}}else{if(l[o].overlap.partial){l[q].overlap.inset++}}}r.cache.events[l[q].overlap.uid]=l[q];r.cache.events[l[o].overlap.uid]=l[o]}}}}for(var s in l){l[s].elems.data(j,l[s])}}t.data(j,r)}},errors:{eventParse:function(n,m){var l=new Error(n);l.type="EventParse";l.event=m;return l},icsParse:function(n,l,o){var m=new Error(n);m.type="ICSParse";m.line=l;m.value=o;return m}},parse:{_icalendar:{folds:/^\s(.*)$/,entry:/^([A-Za-z0-9-]+)((?:;[A-Za-z0-9-]+=(?:"[^"]+"|[^";:,]+)(?:,(?:"[^"]+"|[^";:,]+))*)*):(.*)$/,param:/;([A-Za-z0-9-]+)=((?:"[^"]+"|[^";:,]+)(?:,(?:"[^"]+"|[^";:,]+))*)/g,value:/,?("[^"]+"|[^";:,]+)/g,date:/^(\d{4})(\d\d)(\d\d)$/,time:/^(\d{4})(\d\d)(\d\d)T(\d\d)(\d\d)(\d\d)(Z?)$/,range:/^(\d{4})(\d\d)(\d\d)T(\d\d)(\d\d)(\d\d)(Z?)\/(\d{4})(\d\d)(\d\d)T(\d\d)(\d\d)(\d\d)(Z?)$/,offset:/^([+-])(\d\d)(\d\d)$/,duration:/^([+-])?P(\d+W)?(\d+D)?(T)?(\d+H)?(\d+M)?(\d+S)?$/},icalendar:function(o){var n=k.errors.icsParse,m=k.parse._icalendar,s="cal_begin",t=[],u=o.replace(/\r\n/g,"\n").split("\n"),l=null,q=null;for(var p=u.length-1;p>0;p--){var r=m.folds.exec(u[p]);if(r){u[p-1]+=r[1];u[p]=""}}f.each(u,function(w,v){if(!v){return}switch(s){case"cal_begin":if(v.indexOf("BEGIN:VCALENDAR")==-1){throw new n("Expecting BEGIN:VCALENDAR but found '"+v+"' instead.",w,v)}q={events:[]};s="cal_info";break;case"cal_info":if(v.indexOf("BEGIN:VEVENT")==0){l={};s="cal_event"}if(v.indexOf("END:VCALENDAR")==0){t.push(q);s="done"}if(s!=="cal_info"){return}break;case"cal_event":if(v.indexOf("END:VEVENT")==0){q.events.push(l);s="cal_info"}if(s!=="cal_event"){return}var x=m.entry.exec(v);if(!x){throw new n("Missing entry name.",w,v)}switch(x[1].toLowerCase()){case"uid":l.uid=x[3];break;case"dtstart":l.begins=f[j].date(x[3]);break;case"dtend":l.ends=f[j].date(x[3]);break;case"summary":l.notes=x[3];break}break}});if(s!=="done"){throw new n("Unexpected end of file. Expecting END:VCALENDAR.",u.length,"")}return t.length>0?t.pop():false}},event:{calculateElementCount:function(l){return Math.ceil(l.cache.begins.getDaysBetween(l.cache.ends,true))+1},update:function(r,p,q){var m=f(this),l=m.data(j),o=l&&l.calendar?l.calendar.data(j):false;if(o&&l){var n=l.elems;if("begins" in r){l.begins=f[j].date(r.begins)}if("ends" in r){l.ends=f[j].date(r.ends)}if("color" in r){l.colors=r.color?f[j].colors.generate(r.color):o.settings.defaultcolor}if("title" in r){l.title=r.title||null}if("notes" in r){l.notes=r.notes||""}if(l.ends<o.settings.startdate||l.begins>o.cache.enddate){return false}l.cache.ends=(o.cache.enddate<l.ends?o.cache.enddate.addSeconds(-1):l.ends);l.cache.begins=(o.settings.startdate>l.begins?o.settings.startdate.copy():l.begins);n.find("pre.details").text(l.notes);n.find("p.title").text(l.title||l.begins.format(o.settings.maskeventlabel));n.data(j,l);o.cache.events[l.uid]=l;l.calendar.data(j,o);k.draw[o.type].position.apply(n,[p,q]);return true}return false},edit:function(r){var l=r&&!f(this).is("div.ui-"+j+"-event")?f(this).parents("div.ui-"+j+"-event"):f(this),t=l.data(j),o=t&&t.calendar?t.calendar.data(j):false;if(o&&t){if(!o.settings.allownotesedit){return}var q=l.find("pre.details"),n=q.height();var p=f('<textarea class="details" />').text(t.notes||"").css({boxShadow:"inset 0px 0px 6px "+t.colors.mainShadow}).on("mousedown."+j,function(u){u.stopPropagation()}).appendTo(l);if(l.height()<=30){var s=l.height()<=15?4:1,m=l.height()<=15?-1:0;l.unbind("dblclick."+j).stop(true,true);p.css({marginTop:m,left:s,right:s,height:n,border:"1px solid "+t.colors.mainSelected,borderTop:"none",borderTopLeftRadius:0,borderTopRightRadius:0,opacity:0,overflow:"hidden",zIndex:1}).animate({height:45,opacity:1},"fast",o.settings.easing.eventeditin,function(){f(this).css("overflow","scroll");q.detach();k.selectrange.apply(p,[t.notes.length||0,t.notes.length||0])})}else{q.detach();k.selectrange.apply(p,[t.notes.length||0,t.notes.length||0])}p.blur(function(){var u=t.notes!=f(this).val(),v=t.elems;t.notes=f(this).val();v.attr("title",t.notes||"");if(l.height()<=30){f(this).css("overflow","hidden");f(this).animate({height:n,opacity:0},125,o.settings.easing.eventeditout,function(){f(this).remove()})}else{f(this).remove()}v.append(q.text(t.notes||""));l.bind("dblclick."+j,k.event.edit);if(u){v.data(j,t);o.cache.events[t.uid]=t;t.calendar.data(j,o);o.settings.eventnotesedit.apply(t.calendar,[t.uid,t,v])}})}if(r){r.preventDefault();r.stopPropagation()}},select:function(m,n){var l=f(this),s=l.data(j),o=s&&s.calendar?s.calendar.data(j):false;if(o&&s){if(!o.settings.allowselect){return}if(m===undefined){m="fast"}var q=s.calendar.find("div.ui-"+j+"-event.selected"),r=q.data(j);if(r&&(r.uid===s.uid)){return}var t=o.settings.eventselect.apply(s.calendar,[s.uid,s,l]);if(t===undefined||t){var p=s.elems;q.removeClass("selected");p.addClass("selected");k.draw[o.type].position.apply(p,[m,n]);k.draw[o.type].position.apply(q,[m,n])}}},remove:function(u,m,o){var l=u?f(this).parent("div.ui-"+j+"-event"):f(this),y=l.data(j),p=y&&y.calendar?y.calendar.data(j):false;if(p&&y){if(m===undefined){m="fast"}if(!o){o=p.settings.easing.eventremove}var r=y.elems,z=p.settings.eventremove.apply(y.calendar,[y.uid,y,r,u]),w=function(){f(this).remove()};if(z===undefined||z){var n={width:0,height:0,fontSize:"0em",opacity:0.1};delete p.cache.events[y.uid];y.calendar.data(j,p);switch(r.length){case 1:n.left="+="+(l.width()/2);n.top="+="+(l.height()/2);l.animate(n,m,o,w);break;case 2:var s=r.eq(0),q=r.eq(1),v=f.extend({},n),t=f.extend({},n);v.left="+="+(r.eq(0).width());v.top=p.cache.dayHeight;t.top=0;s.delay(375).animate(v,m,o,w);q.animate(t,m,o,w);break;default:var x=0;r.each(function(){x+=f(this).width()});n.left=l.position().left+p.elements.container.scrollLeft()+(x/2);n.top=p.cache.dayHeight/2;r.first().delay(375).animate(n,m,o,w);r.filter(":not(:first)").animate(n,m,o,w);break}}}if(u){u.preventDefault();u.stopPropagation()}}},drag:{start:function(r){var l=f(this),o=r&&!l.is("div.ui-"+j+"-event")?l.parents("div.ui-"+j+"-event"):l,n=null,m=o.data(j),q=m&&m.calendar?m.calendar.data(j):false;if(q&&m){var p={event:o,data:q,values:m,i:"cal_"+(new Date()).getTime(),type:"resize"};k.drag[p.i]={started:false,startX:r.pageX,startY:r.pageY,lastX:r.pageX,lastY:r.pageY,deltaX:0,deltaY:0,incX:0,incY:0,obTime:m.begins.copy(),oeTime:m.ends.copy(),bTime:m.begins.roundToIncrement(q.settings.dragincrement),eTime:m.ends.roundToIncrement(q.settings.dragincrement),};o.stop(true,true);switch(true){case l.is(".ui-"+j+"-event"):p.lockBegins=Number(q.settings.startdate.format("Ymd"));p.lockEnds=Number(q.cache.enddate.format("Ymd"));p.lockDayBegins=Number(q.settings.daytimestart.replace(/[^0-9]/g,""));p.lockDayEnds=Number(q.settings.daytimeend.replace(/[^0-9]/g,""));p.type="move";f(document).bind("mousemove."+j,p,k.drag.move);break;case l.is(".resize-top"):p.lockDate=m.begins.format("Y-m-d");f(document).bind("mousemove."+j,p,k.drag.resizeB);break;case l.is(".resize-bottom"):p.lockDate=m.ends.format("Y-m-d");f(document).bind("mousemove."+j,p,k.drag.resizeE);break;default:delete k.drag[p.i];return true}f(document).bind("mouseup."+j,p,k.drag.end);r.stopPropagation()}},resizeB:function(r){var m=r.data.event,o=r.data.data,t=r.data.values,p=k.drag[r.data.i];p.deltaY=p.lastY-r.pageY;p.lastY=r.pageY;p.incY+=p.deltaY;if(p.deltaY==0){return true}if(!p.started&&(p.incY>5||p.incY<-5)){p.started=true;m.addClass("ui-dragging ui-resizing")}else{if(p.started){var l=Math.round(p.incY/o.cache.dragHeight);if(l===0){return true}var s=p.bTime.incrementBy(o.settings.dragincrement,0-l);var n=s.format("Y-m-d");var q=s.format("H:i:s");if(n===r.data.lockDate||q!==o.settings.daytimestart){if(n!==r.data.lockDate){s=f[j].date(r.data.lockDate+" "+o.settings.daytimestart);l=Math.round(s.getIncrementBetween(t.begins,o.settings.dragincrement))}if(s>=t.ends){l=Math.round(t.ends.getIncrementBetween(t.begins,o.settings.dragincrement));s=t.ends.incrementBy(o.settings.dragincrement,-1).copy();f(document).unbind("mousemove."+j).bind("mousemove."+j,r.data,k.drag.resizeE)}p.incY-=(l*o.cache.dragHeight);t.begins=p.bTime=s;t.cache.begins=(o.settings.startdate>t.begins?o.settings.startdate.copy():t.begins);m.data(j,t);o.cache.events[t.uid]=t;t.calendar.data(j,o);k.draw[o.type].position.apply(t.elems)}}}},resizeE:function(r){var m=r.data.event,o=r.data.data,t=r.data.values,p=k.drag[r.data.i];p.deltaY=p.lastY-r.pageY;p.lastY=r.pageY;p.incY+=p.deltaY;if(p.deltaY==0){return true}if(!p.started&&(p.incY>5||p.incY<-5)){p.started=true;m.addClass("ui-dragging ui-resizing")}else{if(p.started){var l=Math.round(p.incY/o.cache.dragHeight);if(l===0){return true}var s=p.eTime.incrementBy(o.settings.dragincrement,0-l);var n=s.format("Y-m-d");var q=s.format("H:i:s");if(n===r.data.lockDate||q!==o.settings.daytimeend){if(n!==r.data.lockDate){s=f[j].date(r.data.lockDate+" "+o.settings.daytimeend);l=Math.round(s.getIncrementBetween(t.ends,o.settings.dragincrement))}if(s<=t.begins){l=Math.round(t.begins.getIncrementBetween(t.ends,o.settings.dragincrement));s=t.begins.incrementBy(o.settings.dragincrement,1).copy();f(document).unbind("mousemove."+j).bind("mousemove."+j,r.data,k.drag.resizeB)}p.incY-=(l*o.cache.dragHeight);t.ends=p.eTime=s;t.cache.ends=(o.cache.enddate<s?o.cache.enddate.addSeconds(-1):s);m.data(j,t);o.cache.events[t.uid]=t;t.calendar.data(j,o);k.draw[o.type].position.apply(t.elems)}}}},move:function(r){var n=r.data.event,p=r.data.data,s=r.data.values,q=k.drag[r.data.i];q.deltaX=q.lastX-r.pageX;q.lastX=r.pageX;q.incX+=q.deltaX;q.deltaY=q.lastY-r.pageY;q.lastY=r.pageY;q.incY+=q.deltaY;if(!q.started&&(q.incY>5||q.incY<-5||q.incX>5||q.incY<-5)){q.started=true;n.addClass("ui-dragging")}else{if(q.started){switch(p.type){case h:var l=Math.round(q.incY/p.cache.dragHeight);var o=Math.round(q.incX/p.cache.dayWidth);if(l===0&&o===0){return true}var m=q.bTime.addDays(0-o).incrementBy(p.settings.dragincrement,0-l);var t=q.eTime.addDays(0-o).incrementBy(p.settings.dragincrement,0-l);q.incY-=(l*p.cache.dragHeight);q.incX-=(o*p.cache.dayWidth);s.begins=q.bTime=m;s.ends=q.eTime=t;s.cache.ends=(p.cache.enddate<t?p.cache.enddate.addSeconds(-1):t);s.cache.begins=(p.settings.startdate>s.begins?p.settings.startdate.copy():s.begins);n.data(j,s);p.cache.events[s.uid]=s;s.calendar.data(j,p);k.draw[p.type].position.apply(s.elems);break;case g:n.css({left:"-="+q.deltaX,top:"-="+q.deltaY});break}}}},end:function(o){var m=o.data.event,n=o.data.data,l=o.data.values;switch(o.data.type){case"resize":n.settings.eventresize.apply(l.calendar,[l.uid,l,m]);break;case"move":n.settings.eventmove.apply(l.calendar,[l.uid,l,m]);break}f(document).unbind("mousemove."+j).unbind("mouseup."+j);m.removeClass("ui-dragging ui-resizing");delete k.drag[o.data.i];k.draw[n.type].position.apply(l.elems)}},draw:{week:{cal:function(t){var A,z,B,v,s,u,y,n,q=f[j].date().format("Y-m-d");t.elements.timeblock.css({width:"100%",height:t.cache.incrementHeight});t.elements.timelabel.css({width:"100%",height:t.cache.incrementHeight});for(var p=0,x,m;p<t.cache.incrementsInDay;p++){B=t.settings.startdate.incrementBy(t.settings.gridincrement,p);m=B.format("H:i:s");x=B.format("i");A=t.elements.timeblock.clone(true);A.attr("time",m);A.attr("past",x);u=t.elements.timelabel.clone(true);u.attr("time",m);u.attr("past",x);if(m=="12:00:00"&&"noon" in t.settings.masktimelabel){u.find("p:first").html(B.format(t.settings.masktimelabel.noon))}else{if(x in t.settings.masktimelabel){u.find("p:first").html(B.format(t.settings.masktimelabel[x]))}}t.elements.dayblock.append(A);t.elements.timeline.append(u)}t.elements.dayblock.find("div.ui-"+j+"-time:first").css("border-top","0");t.elements.timeline.find("div.ui-"+j+"-label-time:first").html("");t.elements.dayblock.css({width:t.cache.resourceWidth,height:t.cache.dayHeight});t.elements.resourcelabel.css({width:t.cache.resourceWidth,height:"100%"});t.elements.datelabel.css({width:t.cache.dayWidth,height:"100%"});for(var p=0;p<t.settings.daystodisplay;p++){v=t.settings.startdate.addDays(p);n=v.format("Y-m-d");for(var l=0;l<t.cache.resourcecount;l++){z=t.elements.dayblock.clone(true).css("left",(t.cache.dayWidth*p)+(t.cache.resourceWidth*l)).attr({date:n,day:v.getDay(),resource:k.resource.apply(this,[l,t]).id});if(l<(t.cache.resourcecount-1)){z.addClass("ui-"+j+"-resource")}if(n===q){z.addClass("ui-"+j+"-today")}t.elements.container.append(z);if(t.settings.resources){s=t.elements.resourcelabel.clone(true).css("left",(t.cache.dayWidth*p)+(t.cache.resourceWidth*l)).attr({date:n,day:v.getDay(),resource:k.resource.apply(this,[l,t]).id}).find("p").html(k.resource.apply(this,[l,t]).name).end();t.elements.resourceline.append(s)}}y=t.elements.datelabel.clone(true).css("left",t.cache.dayWidth*p).attr({date:n,day:v.getDay(),}).find("p").html(v.format(t.settings.maskdatelabel)).end();if(n===q){y.addClass("ui-"+j+"-today")}t.elements.dateline.append(y)}t.elements.dateline.add(t.elements.resourceline).css({right:t.cache.scrollbarSize});var w=f(this);w.append(t.elements.timeline).append(t.elements.dateline).append(t.elements.datelinefill).append(t.elements.container);if(f.isArray(t.settings.resources)||typeof t.settings.resources=="object"){w.append(t.elements.resourceline).append(t.elements.resourcelinefill)}var o=(t.cache.dayHeight/2)-(t.elements.container.height()/2);t.elements.container.scrollTop(o)},event:function(p,m){m.cache.ends=(p.cache.enddate<m.ends?p.cache.enddate.addSeconds(-1):m.ends);m.cache.begins=(p.settings.startdate>m.begins?p.settings.startdate.copy():m.begins);var l=k.event.calculateElementCount.apply(this,[m]),n,o;if(!("elems" in m)||m.elems.length<1){n=i.event.clone(true);if(!p.settings.allowremove){n.find("span.button-remove").hide()}if(!p.settings.allowresize){n.find("p.resize-top, p.resize-bottom").hide()}if(p.settings.allowmove){n.find("pre.details").bind("selectstart."+j,k.prevent)}else{n.unbind("mousedown."+j,k.drag.start)}n.attr("data-id",m.uid);n.find("pre.details").text(m.notes);n.find("p.title").text(m.title||m.begins.format(p.settings.maskeventlabel));o=n}else{o=m.elems.detach();if(o.length>l){o.slice(0,l)}n=o.removeClass("begin end").addClass("mid").eq(0)}while(l>o.length){o=o.add(n.clone(true))}if(p.settings.startdate<=m.begins){o.first().removeClass("mid").addClass("begin")}if(p.cache.enddate>=m.ends){o.last().removeClass("mid").addClass("end")}p.elements.container.append(o);m.elems=o;o.data(j,m);k.draw[p.type].position.apply(o)},position:function(p,q,m){var o=f(this),l=o.data(j),n=l&&l.calendar?l.calendar.data(j):false,m=m===undefined?true:m;if(n&&l){o.each(function(v,s){var r=f(s),y=f[j].date(l.begins.addDays(v),n.settings.daytimestart),w=f[j].date(l.begins.addDays(v),n.settings.daytimeend);if(m){var t=l.overlap.items;k.overlaps.apply(l.calendar,[y,w,l.resource]);l=r.data(j);for(var x in l.overlap.items){k.draw[n.type].position.apply(l.overlap.items[x].elems,[false,false,false])}for(var x in t){if(!(x in l.overlap.items)){k.draw[n.type].position.apply(t[x].elems,[false,false,true])}}}var z={top:v>0?0:n.cache.incrementHeight*f[j].date(l.cache.begins,n.settings.daytimestart).getIncrementBetween(l.cache.begins,n.settings.gridincrement),left:n.cache.dayWidth*(n.settings.startdate.getDaysBetween(l.cache.begins,true)+v)+(n.cache.resourceWidth*l.resource),width:(l.resource!==null?n.cache.resourceWidth:n.cache.dayWidth)-1,height:Math.min(n.cache.dayHeight,n.cache.incrementHeight*(v<1?l.begins:y).getIncrementBetween((v==o.length-1?l.cache.ends:w),n.settings.gridincrement)),backgroundColor:r.hasClass("selected")?l.colors.mainSelected:l.colors.mainBackground,textShadow:l.colors.mainTextShadow+" 1px 1px 1px",color:l.colors.mainText};z.width-=n.settings.overlapoffset*l.overlap.count;z.left+=n.settings.overlapoffset*l.overlap.inset;var u={backgroundColor:l.colors.detailsBackground,textShadow:l.colors.detailsTextShadow+" 1px 1px 1px",color:l.colors.detailsText};if(z.height<=15){u.display="none";r.attr("title",l.notes||"").unbind("dblclick."+j).bind("dblclick."+j,k.event.edit)}else{u.display="block";r.removeAttr("title").unbind("dblclick."+j)}if(!l.title){r.find("p.title").text(l.begins.format(n.settings.maskeventlabel))}if(!p){r.css(z);r.find("pre.details").css(u)}else{r.stop(true,false).animate(z,p,q||n.settings.easing.eventupdate).find("pre.details").stop(true,false).animate(u,p,q||n.settings.easing.eventupdate).css("display",u.display);if(jQuery.ui===undefined){r.css({backgroundColor:z.backgroundColor,textShadow:z.textShadow,color:z.color});r.find("pre.details").css({backgroundColor:u.backgroundColor,textShadow:u.textShadow,color:u.color})}}})}}},month:{cal:function(m){var p,t,s,q,l,o=f[j].date().format("Y-m-d");m.elements.datelabel.css({width:m.cache.dayWidth,height:"100%"});m.elements.dayblock.css({width:m.cache.dayWidth,height:m.cache.dayHeight});for(var n=0;n<m.settings.daystodraw;n++){q=m.settings.startdate.addDays(n);l=q.format("Y-m-d");t=m.elements.dayblock.clone(true).attr({date:l,day:q.getDay()}).css({left:m.cache.dayWidth*(n%7),top:m.cache.dayHeight*Math.floor(n/7)}).toggleClass("non-month",q.getMonth()+1!=m.settings.startmonth).find("p").text(q.getDate()).end();if(l===o){t.addClass("ui-"+j+"-today")}if(n<7){s=m.elements.datelabel.clone(true).attr({date:l,day:q.getDay()}).css("left",m.cache.dayWidth*n).find("p").html(q.format(m.settings.maskmonthlabel)).end();m.elements.dateline.append(s)}m.elements.container.append(t)}var r=f(this);r.append(m.elements.dateline).append(m.elements.container)},event:function(p,m){m.cache.ends=(p.cache.enddate<m.ends?p.cache.enddate.addSeconds(-1):m.ends);m.cache.begins=(p.settings.startdate>m.begins?p.settings.startdate.copy():m.begins);var l=k.event.calculateElementCount.apply(this,[m]),n,o;if(!("elems" in m)||m.elems.length<1){n=i.event.clone(true);if(!p.settings.allowremove){n.find("span.button-remove").hide()}if(!p.settings.allowmove){n.unbind("mousedown."+j,k.drag.start)}n.find("p.resize-top, p.resize-bottom").hide();n.attr("data-id",m.uid);n.find("pre.details").text(m.notes);n.find("p.title").text("● "+(m.title||m.begins.format(p.settings.maskeventlabel)));n.attr("title",m.notes||"").unbind("dblclick."+j).bind("dblclick."+j,k.event.edit);o=n}else{o=m.elems.detach();if(o.length>l){o.slice(0,l)}n=o.removeClass("begin end").addClass("mid").eq(0)}while(l>o.length){o=o.add(n.clone(true))}if(p.settings.startdate<=m.begins){o.first().removeClass("mid").addClass("begin")}if(p.cache.enddate>=m.ends){o.last().removeClass("mid").addClass("end")}p.elements.container.append(o);m.elems=o;o.data(j,m);k.draw[p.type].position.apply(o)},position:function(p,q,m){var o=f(this),l=o.data(j),n=l&&l.calendar?l.calendar.data(j):false,m=m===undefined?true:m;if(n&&l){o.each(function(t,w){var s=f(w),v=s.hasClass("selected"),u=o.length>1;var r={top:n.cache.dayHeight*Math.floor((l.begins.addDays(t).getDate()-1)/7)+2+18,left:(n.cache.dayWidth*((l.begins.addDays(t).getDate()-1)%7))+(t>0?0:2),width:n.cache.dayWidth-(u&&t==0?2:4),height:n.cache.incrementHeight,backgroundColor:v?l.colors.mainSelected:"transparent",textShadow:v?l.colors.mainTextShadow+" 1px 1px 1px":"none",color:v?l.colors.mainText:l.colors.mainBackground};s.attr("title",l.notes||"");if(v){if(w.style.removeAttribute){w.style.removeAttribute("background-image")}else{w.style.removeProperty("background-image")}s.find("span.button-remove").show();if(u&&t==0){s.find("span.button-remove").hide()}if(t>0){s.find("p.title").hide()}}else{w.style.backgroundImage="none";s.find("span.button-remove").hide();if(t>0){s.find("p.title").show()}}if(!p){s.css(r).find("pre.details").hide()}else{s.stop(true,false).animate(r,p,q||n.settings.easing.eventupdate).find("pre.details").hide();if(jQuery.ui===undefined){s.css({backgroundColor:r.backgroundColor,textShadow:r.textShadow,color:r.color})}}})}}}}};var i={event:f(['<div class="ui-'+j+'-event mid">','<p class="resize-top" />','<p class="title" />','<span class="button-remove" />','<pre class="details" />','<p class="footer" />','<p class="resize-bottom" />',"</div>"].join("")).bind("selectstart."+j,k.prevent).bind("mousedown."+j,k.event.select).bind("mousedown."+j,k.drag.start).find("p.resize-top, p.resize-bottom").bind("mousedown."+j,k.drag.start).end().find("pre.details").bind("dblclick."+j,k.event.edit).end().find("p").bind("selectstart."+j,k.prevent).end().find("span.button-remove").bind("click."+j,k.event.remove).end(),day:f('<div class="ui-'+j+'-date" date="" day="" />').bind("selectstart."+j,k.prevent),time:f('<div class="ui-'+j+'-time" time="" past="" />'),labels:{time:f('<div class="ui-'+j+'-label-time" time="" past="" ><p /></div>'),date:f('<div class="ui-'+j+'-label-date" date=""><p /><div class="delimiter" /></div>'),resource:f('<div class="ui-'+j+'-label-resource" date=""><p /><div class="delimiter" /></div>'),},timeline:f('<div class="ui-'+j+'-timeline" />').bind("selectstart."+j,k.prevent),dateline:f('<div class="ui-'+j+'-dateline" />').bind("selectstart."+j,k.prevent),datelinefill:f('<div class="ui-'+j+'-dateline-fill" />'),resourceline:f('<div class="ui-'+j+'-resourceline" />'),resourcelinefill:f('<div class="ui-'+j+'-resourceline-fill" />'),container:f('<div class="ui-'+j+'-wrapper" />').bind("scroll."+j,k.onscroll)};var c={init:function(l){return f(this).each(function(){var n=f.extend({},e);if(l){f.extend(n,l)}var s=f(this),o=s.data(j);if(!o){o={type:h,target:s,settings:n,elements:{},cache:{scrollbarSize:k.scrollbarSize(),enddate:undefined,incrementsInDay:undefined,incrementHeight:undefined,dragHeight:undefined,dayWidth:undefined,dayHeight:undefined,events:{},calendars:{}}};if(o.settings.startmonth===null&&o.settings.startyear===null&&o.settings.monthstodisplay===null){if(o.settings.startdate===null){o.settings.startdate=new Date()}if(o.settings.daystodisplay===null){o.settings.daystodisplay=7}}else{if(o.settings.startmonth===null){o.settings.startmonth=(new Date()).getMonth()+1}if(o.settings.startyear===null){o.settings.startyear=(new Date()).getFullYear()}if(o.settings.monthstodisplay===null){o.settings.monthstodisplay=1}o.settings.startdate=f[j].date(o.settings.startyear+"-"+(Number(o.settings.startmonth)<10?"0":"")+Number(o.settings.startmonth)+"-01");o.cache.enddate=o.settings.startdate.addMonths(o.settings.monthstodisplay);o.settings.daystodisplay=o.settings.startdate.getDaysBetween(o.cache.enddate);o.type=g}o.settings.startdate=f[j].date(o.settings.startdate,o.settings.daytimestart);o.settings.defaultcolor=f[j].colors.generate(o.settings.defaultcolor);o.settings.invalidcolor=f[j].colors.generate(o.settings.invalidcolor);o.settings.minheight=Math.round(o.settings.minheight===null?f[j].incrementsIn(o.settings.gridincrement,"1 min"):o.settings.minheight);o.cache.enddate=o.settings.startdate.addDays(o.settings.daystodisplay);o.cache.incrementsInDay=o.settings.startdate.getIncrementBetween(f[j].date(o.settings.startdate,o.settings.daytimeend),o.settings.gridincrement);o.cache.incrementHeight=o.settings.minheight;o.cache.dragHeight=(o.cache.incrementHeight/f[j].incrementsIn(o.settings.gridincrement,o.settings.dragincrement));o.cache.resourcecount=1;s.addClass("ui-"+j+" ui-"+j+"-container ui-"+j+"-"+o.type);o.elements.dateline=i.dateline.clone(true);o.elements.container=i.container.clone(true);o.elements.dayblock=i.day.clone(true);o.elements.datelabel=i.labels.date.clone(true);o.elements.resourcelabel=i.labels.resource.clone(true);switch(o.type){case g:var p=o.settings.startdate.getDay();var m=o.cache.enddate.addDays(1).getDay();var r=o.settings.weekstart-1;var u=r==0?6:r-1;o.settings.startdate=o.settings.startdate.addDays((r>p?r-7:r)-p);o.cache.enddate=o.cache.enddate.addDays(u-m+2);o.settings.daystodraw=o.settings.startdate.getDaysBetween(o.cache.enddate);o.cache.weekstodraw=o.settings.startdate.getWeeksBetween(o.cache.enddate);o.elements.dayblock.append("<p/>");o.cache.monthWidth=s.outerWidth()/o.settings.monthstodisplay;o.cache.dayWidth=o.cache.monthWidth/7;o.cache.dayHeight=(s.outerHeight()-22)/o.cache.weekstodraw;k.draw.month.cal.apply(this,[o]);break;case h:if(f.isArray(o.settings.resources)||typeof o.settings.resources=="object"){o.cache.resourcecount=0;for(var q in o.settings.resources){if(o.settings.resources.hasOwnProperty(q)){o.cache.resourcecount++}}s.addClass("ui-"+j+"-resources");o.elements.resourceline=i.resourceline.clone(true);o.elements.resourcelinefill=i.resourcelinefill.clone(true)}o.elements.datelinefill=i.datelinefill.clone(true);o.elements.timeline=i.timeline.clone(true);o.elements.timeblock=i.time.clone(true);o.elements.timelabel=i.labels.time.clone(true);var t=(s.outerWidth()-60)/(o.settings.daystodisplay*o.cache.resourcecount);o.cache.resourceWidth=Math.max(o.settings.minwidth,t);o.cache.dayWidth=o.cache.resourceWidth*o.cache.resourcecount;o.cache.dayHeight=o.cache.incrementHeight*o.cache.incrementsInDay;k.draw.week.cal.apply(this,[o]);break}s.data(j,o);if(!f.isArray(o.settings.calendars)){o.settings.calendars=[o.settings.events]}f(o.settings.calendars).each(function(){var x,v;if(f.isArray(this)){x=this}else{if(typeof this=="string"){x=this}else{if(f.isPlainObject(this)){x=this.events;v=this.color}}}if(f.isArray(x)){for(var w=0;w<x.length;w++){if(!("color" in x[w])){x[w].color=v}c.add.apply(s,[x[w]])}}else{if(typeof x=="string"){f.ajax(x,{accepts:"text/calendar",dataType:"text",type:"get",crossDomain:true,data:{from:o.settings.datefrom,to:o.settings.dateto},success:function(y){var B=k.parse.icalendar.apply(s,[y]);if(B&&"events" in B&&f.isArray(B.events)&&B.events.length>0){for(var z=0,A;z<B.events.length;z++){if(!("color" in B.events[z])){B.events[z].color=v}c.add.apply(s,[B.events[z]])}}}})}}});o.settings.calendars=undefined;o.settings.events=undefined;o.settings.onload.apply(s)}})},add:function(q){var o=f(this),m=o.data(j);if(m){if(!"uid" in q){throw k.errors.eventParse("Missing unique id (uid)",q)}if(!"begins" in q){throw k.errors.eventParse("Missing start date/time (begins)",q)}if(!"ends" in q){throw k.errors.eventParse("Missing end date/time (ends)",q)}if(q.uid in m.cache.events){throw k.errors.eventParse("UID must be unique",q)}var n=f[j].date(q.begins),p=f[j].date(q.ends);var l={elems:f([]),calendar:o,uid:q.uid,begins:n,ends:p,resource:m.settings.resources&&q.resource?k.resourceIndex.apply(this,[q.resource,m]):null,colors:q.color?f[j].colors.generate(q.color):m.settings.defaultcolor,title:q.title||null,notes:q.notes||"",cache:{},overlap:{inset:[],depth:[]}};if(l.resource===false){throw k.errors.eventParse("Invalid resource id (resource)",q)}if(!(l.begins instanceof Date)){throw k.errors.eventParse("Invalid start date/time (begins)",q)}m.cache.events[l.uid]=l;o.data(j,m);if(k.inrange.apply(this,[n,p,m.settings.startdate,m.cache.enddate])){k.draw[m.type].event.apply(o,[m,l])}}return o},update:function(l,p,r){var q=f(this),m,o=q.data(j);if(o){if(p===undefined){p="fast"}if(f.isArray(l)){for(var n=0;n<l.length;n++){m=o.elements.container.find("div.ui-"+j+'-event[data-id="'+l[n].uid+'"]');if(m.length>0){k.event.update.apply(m,[l[n],p,r])}}}else{m=o.elements.container.find("div.ui-"+j+'-event[data-id="'+l.uid+'"]');if(m.length>0){k.event.update.apply(m,[l,p,r])}}}return q},select:function(l,n,p){var o=f(this),m=o.data(j);if(m){$event=m.elements.container.find("div.ui-"+j+'-event[data-id="'+l+'"]');if($event.length>0){k.event.select.apply($event,[n,p])}}return o},option:function(u,t){var s=f(this),q=s.data(j);if(q){if(typeof u=="undefined"){return q.settings}if(typeof u=="object"){for(var n in u){if(u.hasOwnProperty(n)){c.option.apply(s,[n,u[n]])}}return s}if(!u in q.settings){return false}if(typeof t=="undefined"){return q.settings[u]}else{switch(u){case"allowremove":q.elements.container.find("div.ui-"+j+"-event span.button-remove").toggle(Boolean(t));break;case"allowresize":q.elements.container.find("p.resize-top, p.resize-bottom").toggle(Boolean(t));break;case"startdate":var r=f[j].date(t,q.settings.daytimestart),v=q.settings.startdate;q.settings.startdate=r;q.cache.enddate=r.addDays(q.settings.daystodisplay);s.data(j,q);var m;for(var p in q.cache.events){m=q.cache.events[p];if(!k.inrange.apply(this,[m.begins,m.ends,q.settings.startdate,q.cache.enddate])){if("elems" in m&&m.elems.length>0){m.elems.detach()}}else{k.draw[q.type].event.apply(s,[q,m])}}var l=f("div.ui-"+j+"-date",q.elements.container).removeClass("ui-"+j+"-today"),o=f[j].date().format("Y-m-d");switch(q.type){case g:f(q.elements.dayblock).removeClass("ui-"+j+"-today").each(function(y,x){var A=f(x),w=r.addDays(y),z=w.format("Y-m-d");A.attr({date:z,day:w.getDay()}).find("p").html(w.format("j")).end();if(z===o){A.addClass("ui-"+j+"-today")}});break;case h:f("div.ui-"+j+"-label-date",q.elements.dateline).removeClass("ui-"+j+"-today").each(function(z,y){var w=f(y),x=r.addDays(z),A=x.format("Y-m-d");l.eq(z).attr({date:A,day:x.getDay()});w.attr({date:A,day:x.getDay()}).find("p").html(x.format(q.settings.maskdatelabel)).end();if(A===o){w.add(l.eq(z)).addClass("ui-"+j+"-today")}});break}return s;break;default:q.settings[u]=t;break}return s}}},version:function(){return j+" v"+d},destroy:function(){return this.each(function(){var n=f(this),m=n.data(j);if(m){for(var l=0;l<m.cache.events.length;l++){m.cache.events[l].elems.remove()}n.removeData(j);n.empty()}})}};f.fn[j]=function(l){if(c[l]){return c[l].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof l==="object"||!l){return c.init.apply(this,arguments)}else{f.error("Method "+l+" does not exist on jQuery."+j)}}};f[j]={};f[j].colors={named:{aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370D8",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#D87093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",reactorblue:"#0266A1",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},HexToRGB:function(m,l){return(l!==undefined?"rgba":"rgb")+"("+f[j].colors.HexToR(m)+", "+f[j].colors.HexToG(m)+", "+f[j].colors.HexToB(m)+(l!==undefined?", "+l+")":")")},HexToR:function(l){return parseInt((f[j].colors.cutHex(l)).substring(0,2),16)},HexToG:function(l){return parseInt((f[j].colors.cutHex(l)).substring(2,4),16)},HexToB:function(l){return parseInt((f[j].colors.cutHex(l)).substring(4,6),16)},cutHex:function(l){return(l.charAt(0)=="#")?f[j].colors.padHex(l.substring(1,7)):f[j].colors.padHex(l)},padHex:function(l){return l.length>3?l:l.substring(0,1)+l.substring(0,1)+l.substring(1,2)+l.substring(1,2)+l.substring(2,3)+l.substring(2,3)},HueToRGB:function(n,m,l){if(l<0){l+=1}if(l>1){l-=1}if(l<1/6){return n+(m-n)*6*l}if(l<1/2){return m}if(l<2/3){return n+(m-n)*(2/3-l)*6}return n},HSLToRGB:function(u,A,t,z,w){var m,v,y;u/=360;A/=100;t/=100;if(A==0){m=v=y=t}else{var n=t<0.5?t*(1+A):t+A-t*A;var o=2*t-n;m=f[j].colors.HueToRGB(o,n,u+1/3);v=f[j].colors.HueToRGB(o,n,u);y=f[j].colors.HueToRGB(o,n,u-1/3)}var x=[Math.round(m*255),Math.round(v*255),Math.round(y*255)];if(w){if(z!==undefined){x[3]=z}return x}return(z!==undefined?"rgba":"rgb")+"("+x.join(", ")+(z!==undefined?", "+z+")":")")},RGBToHSL:function(m,q,u){m/=255,q/=255,u/=255;var v=Math.max(m,q,u),o=Math.min(m,q,u);var p,w,n=(v+o)/2;if(v==o){p=w=0}else{var t=v-o;w=n>0.5?t/(2-v-o):t/(v+o);switch(v){case m:p=(q-u)/t+(q<u?6:0);break;case q:p=(u-m)/t+2;break;case u:p=(m-q)/t+4;break}p/=6}return[Math.round(p*360),Math.round(w*100),Math.round(n*100)]},brightness:function(n,m,l){return((n*299)+(m*587)+(l*114))/1000},generate:function(m){var l=10;if(m in f[j].colors.named){m=f[j].colors.named[m]}if(m.match(/^#?([0-9A-Fa-f]{3,6})$/)){var q=[f[j].colors.HexToR(m),f[j].colors.HexToG(m),f[j].colors.HexToB(m)];var s=f[j].colors.RGBToHSL(q[0],q[1],q[2])}else{if(m.replace(/ /g,"").match(/([rR][gG][bB]\s*\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|([rR][gG][bB]\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\))/)){var q=m.replace(/[a-zA-Z\(\) ]/g,"").split(",");var s=f[j].colors.RGBToHSL(q[0],q[1],q[2])}else{if(m.replace(/ /g,"").match(/([hH][sS][lL]\s*\(\s*([0-9]|[1-9][0-9]|[1-2][0-9][0-9]|3[0-5][0-9]|360)\s*,\s*(\d?\d%|100%)\s*,\s*(\d?\d%|100%)\s*\))/)){var s=m.replace(/[a-zA-Z\(\) %]/g,"").split(",")}else{throw new Error("Invalid Colour: could not parse "+m+" as a color.")}}}if(s[1]<l){s[1]+=l}if(s[1]>100-l){s[1]-=l}if(s[2]>100-l){s[2]-=l}if(s[2]<l){s[2]+=l}function n(x,w,u){var v=f.extend([],x);v[1]=Math.max(0,v[1]+(w/2));v[2]=Math.min(100,v[2]+w);if(u!==undefined){v[3]=u}return v}function t(x,w,u){var v=f.extend([],x);v[2]=Math.max(0,v[2]-w);if(u!==undefined){v[3]=u}return v}var o=f[j].colors.HSLToRGB.apply(this,n(s,l*5,0.3));var p=f[j].colors.HSLToRGB.apply(this,n(s,l*3,0.75));var r=(f[j].colors.brightness.apply(this,f[j].colors.HSLToRGB(s[0],s[1],s[2],undefined,true))>125?"#333333":"#FFFFFF");return{original:m,mainBackground:f[j].colors.HSLToRGB.apply(this,s),mainTextShadow:o,mainShadow:p,mainText:r,mainSelected:f[j].colors.HSLToRGB.apply(this,t(s,l)),detailsBackground:f[j].colors.HSLToRGB.apply(this,n(s,l)),detailsTextShadow:o,detailsShadow:p,detailsText:r}}};f[j].lang={en:{short_month:Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"),long_month:Array("January","February","March","April","May","June","July","August","September","October","November","December"),short_day:Array("Sun","Mon","Tue","Wed","Thu","Fri","Sat"),long_day:Array("Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"),label_remove:"Remove",label_today:"Today"}};var a={d:function(){return(this.getDate()<10?"0":"")+this.getDate()},D:function(){return f[j].lang[this.lang].short_day[this.getDay()]},j:function(){return this.getDate()},l:function(){return f[j].lang[this.lang].long_day[this.getDay()]},N:function(){return this.getDay()+1},S:function(){return(this.getDate()%10==1&&this.getDate()!=11?"st":(this.getDate()%10==2&&this.getDate()!=12?"nd":(this.getDate()%10==3&&this.getDate()!=13?"rd":"th")))},w:function(){return this.getDay()},z:function(){if(window.console){console.error("Mask 'z' Not Yet Supported")}return"z"},W:function(){var l=new Date(this.getFullYear(),0,1);return Math.ceil((((this-l)/86400000)+l.getDay()+1)/7)},F:function(){return f[j].lang[this.lang].long_month[this.getMonth()]},m:function(){return(this.getMonth()+1<10?"0":"")+(this.getMonth()+1)},M:function(){return f[j].lang[this.lang].short_month[this.getMonth()]},n:function(){return this.getMonth()+1},t:function(){return(new Date((new Date(this.getFullYear(),this.getMonth()+1,1))-1)).getDate()},L:function(){if(window.console){console.error("Mask 'L' Not Yet Supported")}return"L"},o:function(){if(window.console){console.error("Mask 'o' Not Yet Supported")}return"o"},Y:function(){return this.getFullYear()},y:function(){return(""+this.getFullYear()).substr(2)},a:function(){return this.getHours()<12?"am":"pm"},A:function(){return this.getHours()<12?"AM":"PM"},B:function(){if(window.console){console.error("Mask 'B' Not Yet Supported")}return"B"},g:function(){return this.getHours()==0?12:(this.getHours()>12?this.getHours()-12:this.getHours())},G:function(){return this.getHours()},h:function(){return(this.getHours()<10||(12<this.getHours()<22)?"0":"")+(this.getHours()<10?this.getHours()+1:this.getHours()-12)},H:function(){return(this.getHours()<10?"0":"")+this.getHours()},i:function(){return(this.getMinutes()<10?"0":"")+this.getMinutes()},s:function(){return(this.getSeconds()<10?"0":"")+this.getSeconds()},e:function(){if(window.console){console.error("Mask 'e' Not Supported")}return"e"},I:function(){if(window.console){console.error("Mask 'I' Not Supported")}return"I"},O:function(){return this.toString().match(/GMT([+-][0-9]+) \(([a-zA-Z]+)\)/)[1]},P:function(){var l=this.toString().match(/GMT([+-][0-9]+) \(([a-zA-Z]+)\)/)[1].split("");l.splice(-2,0,":");return l.join("")},T:function(){return this.toString().match(/GMT([+-][0-9]+) \(([a-zA-Z]+)\)/)[2]},Z:function(){return this.getTimezoneOffset()*60},c:function(){return a.Y.apply(this)+"-"+a.m.apply(this)+"-"+a.d.apply(this)+"T"+a.H.apply(this)+":"+a.i.apply(this)+":"+a.s.apply(this)+a.P.apply(this)},C:function(){return a.c.apply(this).replace(a.P.apply(this),"")+"Z"},r:function(){return this.toString()},U:function(){return this.getTime()/1000}};var b={d:function(){return(this.getUTCDate()<10?"0":"")+this.getUTCDate()},D:function(){return f[j].lang[this.lang].short_day[this.getUTCDay()]},j:function(){return this.getUTCDate()},l:function(){return f[j].lang[this.lang].long_day[this.getUTCDay()]},N:function(){return this.getUTCDay()+1},S:function(){return(this.getUTCDate()%10==1&&this.getUTCDate()!=11?"st":(this.getUTCDate()%10==2&&this.getUTCDate()!=12?"nd":(this.getUTCDate()%10==3&&this.getUTCDate()!=13?"rd":"th")))},w:function(){return this.getUTCDay()},z:a.z,W:function(){var l=new Date(this.getUTCFullYear(),0,1);return Math.ceil((((this-l)/86400000)+l.getUTCDay()+1)/7)},F:function(){return f[j].lang[this.lang].long_month[this.getUTCMonth()]},m:function(){return(this.getUTCMonth()+1<10?"0":"")+(this.getUTCMonth()+1)},M:function(){return f[j].lang[this.lang].short_month[this.getUTCMonth()]},n:function(){return this.getUTCMonth()+1},t:function(){return(new Date((new Date(this.getUTCFullYear(),this.getUTCMonth()+1,1))-1)).getUTCDate()},L:a.L,o:a.o,Y:function(){return this.getUTCFullYear()},y:function(){return(""+this.getUTCFullYear()).substr(2)},a:function(){return this.getUTCHours()<12?"am":"pm"},A:function(){return this.getUTCHours()<12?"AM":"PM"},B:a.B,g:function(){return this.getUTCHours()==0?12:(this.getUTCHours()>12?this.getUTCHours()-12:this.getUTCHours())},G:function(){return this.getUTCHours()},h:function(){return(this.getUTCHours()<10||(12<this.getUTCHours()<22)?"0":"")+(this.getUTCHours()<10?this.getUTCHours()+1:this.getUTCHours()-12)},H:function(){return(this.getUTCHours()<10?"0":"")+this.getUTCHours()},i:function(){return(this.getUTCMinutes()<10?"0":"")+this.getUTCMinutes()},s:function(){return(this.getUTCSeconds()<10?"0":"")+this.getUTCSeconds()},e:a.e,I:a.I,O:a.O,P:a.P,T:a.T,Z:a.Z,c:function(){return b.Y.apply(this)+"-"+b.m.apply(this)+"-"+b.d.apply(this)+"T"+b.H.apply(this)+":"+b.i.apply(this)+":"+b.s.apply(this)+b.P.apply(this)},C:function(){return b.c.apply(this).replace(b.P.apply(this),"")+"Z"},r:a.r,U:function(){return this.getUTCTime()/1000}};f[j].format=function(m,r,p){var q="",l="";var o=p?b:a;for(var n=0;n<r.length;n++){l=r.charAt(n);if(l=="\\"&&o[r.charAt(n+1)]){q+=r.charAt(n+1);n++}else{if(a[l]){q+=o[l].call(m)}else{q+=l}}}return q};f[j].date=function(r,p,l){var t;var v;if(r instanceof Date){t=new Date(Date.UTC(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),0));if(p!==undefined){var u=p.match(/[0-9]{1,2}:[0-9]{1,2}:[0-9]{1,2}([Zz])?/)?true:p==""?true:false;if(u){var q,o,z;q=o=D=0;p=p.split(":");q=p[0];o=p[1];D=p[2];if((p[3]||"").toLowerCase()=="z"){t.setUTCHours(q);t.setUTCMinutes(o);t.setUTCSeconds(D)}else{t.setHours(q);t.setMinutes(o);t.setSeconds(D)}}}if("lang" in t){return t}}else{if(typeof r=="string"||(r&&typeof r=="object"&&"toString" in r)){if(r.toString()!==""){var x=r.toString().split(/[Tt ]/);if(p!==undefined){x[1]=!p?"":p}var C=0 in x?(x[0]==""?null:x[0].match(/([0-9]{2,4})-?([0-9]{2})-?([0-9]{2})/)):null;var B=1 in x?(x[1]==""?null:x[1].match(/([0-9]{2}):?([0-9]{2}):?([0-9]{2})([Zz])?/)):null;if(C===null){var w=new Date();C=["",w.getFullYear(),w.getMonth()+1,w.getDate()]}if(B===null){B=["",0,0,0]}if(C&&B){var A=C[1],n=C[2]-1,z=C[3],q=B[1],o=B[2],D=B[3];if((B[4]||"").toLowerCase()=="z"){t=new Date(Date.UTC(A,n,z,q,o,D,0))}else{t=new Date(A,n,z,q,o,D)}}}}}if(!(t instanceof Date)||isNaN(t)){t=new Date()}t.lang=l||"en";t.roundToDay=function(){return f[j].date(new Date(this.getUTCFullYear(),this.getUTCMonth(),this.getUTCDate(),0,0,0))};t.roundToMonth=function(){return f[j].date(new Date(this.getUTCFullYear(),this.getUTCMonth(),1,0,0,0))};t.getUTCTime=function(){return this.getTime()+(this.getTimezoneOffset()*60000)};t.getYearsBetween=function(y,s){var m=this.getMonthsBetween(y);return Math.floor(m/12)};t.getMonthsBetween=function(I,m){var G=this.copy(),F=I.copy();var E=G.copy();E.setDate(1);E.setMonth(E.getMonth()+1);E.setDate(0);E=E.getDate();var s=F.copy();s.setDate(1);s.setMonth(s.getMonth()+1);s.setDate(0);s=s.getDate();if(m){G.setDate(1);F.setDate(1)}var H=G.getFullYear()*12+G.getMonth();var y=F.getFullYear()*12+F.getMonth();if(!m){H+=(((G.getDate()+(G.getHours()/24)+(G.getMinutes()/24/60)-1)/E));y+=(((F.getDate()+(F.getHours()/24)+(G.getMinutes()/24/60)-1)/s))}return y-H};t.getWeeksBetween=function(F,s){var E=this.copy();var y=F.copy();if(s){E=E.addDays(1-E.getDay());E.setHours(0,0,0,0)}var m=E.getDaysBetween(y)/7;return(s?Math.floor(m):m)};t.getDaysBetween=function(F,m){var y=F.copy();if(m){y.setHours(this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds())}var s=((-this.getTimezoneOffset()/60)-(-y.getTimezoneOffset()/60))*3600000;var E=y.getTime()-this.getTime();return(E-s)/86400000};t.getHoursBetween=function(F,m){var y=F.copy();if(m){y.setMinutes(this.getMinutes(),this.getSeconds(),this.getMilliseconds())}var s=((-this.getTimezoneOffset()/60)-(-y.getTimezoneOffset()/60))*3600000;var E=y.getTime()-this.getTime();return(E-s)/3600000};t.getMinutesBetween=function(F,m){var y=F.copy();if(m){y.setSeconds(this.getSeconds(),this.getMilliseconds())}var s=((-this.getTimezoneOffset()/60)-(-y.getTimezoneOffset()/60))*3600000;var E=y.getTime()-this.getTime();return(E-s)/60000};t.getSecondsBetween=function(s,m){return m?Math.round(this.getMinutesBetween(s)*60):this.getMinutesBetween(s)*60};t.addYears=function(G){var F=Math.floor(G);var s=Math.floor((G-F)*12);var E=this.copy();E.setFullYear(this.getFullYear()+F);E.setMonth(this.getMonth()+s);return E};t.addMonths=function(E){var s=Math.floor(E);var y=this.copy();y.setMonth(this.getMonth()+s);return y};t.addDays=function(H){var G=Math.floor(H);var F=Math.floor((H-G)*24);var y=Math.floor(((H-G)-(F/24))*24*60);var E=Math.floor(((H-G)-(F/24)-(y/24/60))*24*60*60);var m=this.copy();m.setDate(this.getDate()+G);m.setHours(this.getHours()+F);m.setMinutes(this.getMinutes()+y);m.setSeconds(this.getSeconds()+E);return m};t.addHours=function(G){var F=Math.floor(G);var y=Math.floor((G-F)*60);var E=Math.floor(((G-F)-(y/60))*60*60);var m=this.copy();m.setHours(this.getHours()+F);m.setMinutes(this.getMinutes()+y);m.setSeconds(this.getSeconds()+E);return m};t.addMinutes=function(F){var y=Math.floor(F);var E=Math.floor((F-y)*60);var m=this.copy();m.setMinutes(this.getMinutes()+y);m.setSeconds(this.getSeconds()+E);return m};t.addSeconds=function(E){var y=Math.floor(E);var m=this.copy();m.setSeconds(this.getSeconds()+y);return m};t.copy=function(){return f[j].date(this.format("Y-m-d H:i:s"))};t.format=function(m){return f[j].format(this,m)};t.formatUTC=function(m){return f[j].format(this,m,true)};t.incrementBy=function(F,y){if(y!==undefined&&(isNaN(Number(y))||!(Number(y)!==0))){return this}if(!(typeof F=="string"||typeof F=="number")&&(F==null||F==undefined||F==false||!("toString" in F))){return this.copy()}var s=F.split(" ");var m=Number(s[0]);var E=s[1]||"hour";if(y!==null&&y!==undefined&&y!==false&&!isNaN(y)){m=m*y}if(m!==0){switch(E.toString().replace(/s$/,"").toLowerCase()){case"sec":case"second":return this.addMinutes(m/60);case"min":case"minute":return this.addMinutes(m);case"hour":return this.addHours(m);case"day":return this.addDays(m);case"week":return this.addDays(m*7);case"month":return this.addMonths(m);case"year":return this.addYears(m)}}return this.copy()};t.getIncrementBetween=function(s,F){if(!(s instanceof Date)||!F){return 0}var y=F.split(" ");var m=Number(y[0]);var E=y[1]||"hour";if(m!==0){switch(E.toString().replace(/s$/,"").toLowerCase()){case"sec":case"second":return((this.getMinutesBetween(s)/60)/m);case"min":case"minute":return(this.getMinutesBetween(s)/m);case"hour":return(this.getHoursBetween(s)/m);case"day":return(this.getDaysBetween(s)/m);case"week":return((this.getDaysBetween(s)/7)/m);case"month":return(this.getMonthsBetween(s)/m);case"year":return(this.getYearsBetween(s)/m)}}return Infinity};t.roundToIncrement=function(K){if(!(typeof K=="string"||typeof K=="number")&&(K==null||K==undefined||K==false||!("toString" in K))){return this.copy()}var I=K.split(" ");var M=Number(I[0]);var L=I[1]||"hour";var F=this.getTime();if(M!==0){var G=0;switch(L.toString().replace(/s$/,"").toLowerCase()){case"sec":case"second":G=1000*M;break;case"min":case"minute":G=60000*M;break;case"hour":G=3600000*M;break;case"day":G=86400000*M;return f[j].date(new Date((Math.round((F+43200000)/G)*G))).addHours(-12);case"week":var s=this.getDay();var E=null;if(s<3){E=this.addDays(0-s)}else{if(s>3){E=this.addDays(7-s)}else{E=this.addDays(this.getHours()>=12?7-s:0-s)}}E.setHours(0,0,0,0);return E;break;case"month":var H=f[j].date(this.format("Y-m-01 00:00:00"));var m=H.getDaysBetween(H.addMonths(1))/2;if(this.getDate()>=m){return H.addMonths(1)}else{return H}break;case"year":var J=f[j].date(this.format("Y-01-01 00:00:00"));var m=J.getDaysBetween(J.addYears(1))/2;var y=J.getDaysBetween(this);if(y>=m){return J.addYears(1)}else{return J}break}return f[j].date(new Date((Math.round(F/G)*G)))}return this};return t};f[j].incrementsIn=function(n,l){var m=f[j].date("1970-01-01 00:00:00");return m.getIncrementBetween(m.incrementBy(n),l)}})(jQuery);